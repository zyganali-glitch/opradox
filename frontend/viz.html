<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8" />
    <title>Opradox – Visual Studio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description"
        content="Opradox Visual Studio - Canlı dashboard oluşturun, grafiklerinizi sürükle bırak ile tasarlayın" />

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BVYYQS8HWY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        const hostname = window.location.hostname;
        if (hostname.includes('opradox.com.tr')) {
            gtag('config', 'G-BVYYQS8HWY');
        } else if (hostname.includes('opradox.com')) {
            gtag('config', 'G-EDHVSD1LM1');
        } else {
            gtag('config', 'G-BVYYQS8HWY');
            gtag('config', 'G-EDHVSD1LM1');
        }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/viz_fixes.css">

    <!-- PWA Manifest (9.2) -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4a90d9">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Opradox">
    <link rel="apple-touch-icon" href="img/icon-192.png">


    <!-- ECharts for Charts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

    <!-- Simple Statistics for Statistical Analysis -->
    <script src="https://cdn.jsdelivr.net/npm/simple-statistics@7.8.3/dist/simple-statistics.min.js"></script>

    <!-- ECharts GL for 3D Charts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts-gl@2.0.9/dist/echarts-gl.min.js"></script>

    <!-- jStat for Advanced Statistics (SPSS-like) -->
    <script src="https://cdn.jsdelivr.net/npm/jstat@1.9.6/dist/jstat.min.js"></script>

    <!-- Regression.js for Trend Lines -->
    <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>

    <!-- Mousetrap for Keyboard Shortcuts -->
    <script src="https://cdn.jsdelivr.net/npm/mousetrap@1.6.5/mousetrap.min.js"></script>

    <!-- jsPDF for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- html2canvas for Screenshot -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <!-- MathJax for LaTeX formula rendering -->
    <script>
        MathJax = {
            tex: { inlineMath: [['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

    <!-- Fabric.js for Annotations -->
    <script src="https://cdn.jsdelivr.net/npm/fabric@5.3.0/dist/fabric.min.js"></script>

    <!-- LZString for URL Compression -->
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>

    <!-- SheetJS for Excel file parsing -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <script defer src="js/fileDocker.js"></script>

    <!-- =============================================== -->
    <!-- DEBUG CATCHER ( Temporary for Dead Buttons Fix ) -->
    <!-- =============================================== -->
    <div id="debug-overlay"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:99999; color:white; font-family:monospace; padding:20px; overflow:auto;">
        <div style="background:#e74c3c; padding:15px; border-radius:5px; margin-bottom:20px;">
            <h2 style="margin:0 0 10px 0;">🚨 HATA YAKALANDI</h2>
            <p>Lütfen aşağıdaki hatayı geliştiriciye bildirin:</p>
            <button onclick="document.getElementById('debug-overlay').style.display='none'"
                style="float:right; margin-top:-30px; background:white; color:black; border:none; padding:5px 10px; cursor:pointer;">Kapat</button>
        </div>
        <pre id="debug-log" style="white-space:pre-wrap; font-size:14px; color:#f1c40f;"></pre>
        <div style="margin-top:20px;">
            <h3>Module Status:</h3>
            <ul id="module-status-list" style="list-style:none; padding:0;"></ul>
        </div>
    </div>
    <script>
        (function () {
            const logEl = document.getElementById('debug-log');
            const overlay = document.getElementById('debug-overlay');
            const listEl = document.getElementById('module-status-list');

            function showErr(msg) {
                overlay.style.display = 'block';
                logEl.textContent += msg + '\n-------------------\n';
                console.error(msg);
            }

            window.onerror = function (msg, url, line, col, error) {
                showErr(`JS ERROR:\nMsg: ${msg}\nFile: ${url}\nLine: ${line}:${col}\nErr: ${error ? error.stack : 'N/A'}`);
                return false;
            };

            window.addEventListener('unhandledrejection', function (event) {
                showErr(`PROMISE ERROR:\nReason: ${event.reason}`);
            });

            window.markModuleLoaded = function (name) {
                const li = document.createElement('li');
                li.innerHTML = `✅ ${name} loaded`;
                li.style.color = '#2ecc71';
                listEl.appendChild(li);
            }
        })();
    </script>

    <!-- FAZ-5: Central Toast System (must load BEFORE modules) -->
    <script src="js/toast.js"></script>

    <!-- =============================================== -->
    <!-- MODULAR VIZ.JS ARCHITECTURE (NEW ES6 MODULES)  -->
    <!-- =============================================== -->
    <script type="module">
        // 1. Core and UI (Load first)
        import './js/modules/core.js';
        import './js/modules/ui.js';
        import './js/modules/preview.js';

        // 2. Data Management
        import './js/modules/data.js';

        // 3. Visualization and Analysis Engines
        import './js/modules/charts.js';
        import './js/modules/stats.js';
        import './js/modules/advanced.js';

        // 4. Initialize System
        // 4. Initialize System
        const initSystem = () => {
            console.log('🚀 Opradox Modular System Initializing...');

            // Window binding check
            if (typeof window.initVizStudio === 'function') {
                window.initVizStudio();
            } else {
                console.error('🚨 CRITICAL ERROR: initVizStudio not found on window! Is core.js loaded?');
                // Fallback: Manual initialization attempt
                import('./js/modules/core.js').then(module => {
                    if (module.initVizStudio) module.initVizStudio();
                });
            }
        };

        if (document.readyState === 'loading') {
            window.addEventListener('DOMContentLoaded', initSystem);
        } else {
            initSystem();
        }
    </script>

    <!-- Legacy file handlers REMOVED - files don't exist (404) -->

    <!-- FAZ 1A: Compatibility Layer for Missing Window Bindings -->
    <script defer src="js/adapters.js"></script>

    <!-- SELFTEST: Only loaded via adapters.js when ?selftest=1 is in URL -->
</head>


<body class="dark-mode">
    <div class="viz-studio-root">

        <!-- HEADER with Navigation -->
        <header class="gm-header">
            <div class="gm-logo-box">
                <a href="hub.html" class="gm-back-to-hub" title="Hub'a Dön">
                    <i class="fas fa-th-large"></i>
                </a>
                <a href="hub.html" class="brand-wordmark" style="text-decoration:none; margin-left:10px;">Opradox</a>
                <div style="width:1px; height:24px; background:var(--gm-divider); margin:0 15px;"></div>
                <span class="gm-logo-subtitle" data-i18n="viz_subtitle" style="border:none; padding:0; margin:0;">Visual
                    Studio</span>
            </div>

            <!-- Module Navigation -->
            <nav class="gm-module-nav">
                <a href="excel.html" class="gm-module-tab" data-module="excel">
                    <i class="fas fa-file-excel"></i> <span data-i18n="module_excel">Excel</span>
                </a>
                <a href="viz.html" class="gm-module-tab active" data-module="viz">
                    <i class="fas fa-chart-line"></i> <span data-i18n="module_viz">Viz</span>
                </a>
                <a href="pdf.html" class="gm-module-tab" data-module="pdf">
                    <i class="fas fa-file-pdf"></i> <span data-i18n="module_pdf">PDF</span>
                </a>
                <a href="ocr.html" class="gm-module-tab" data-module="ocr">
                    <i class="fas fa-eye"></i> <span data-i18n="module_ocr">OCR</span>
                </a>
            </nav>

            <div class="gm-header-right">
                <button class="gm-pill-btn" id="saveBtn">
                    <i class="fas fa-save"></i> <span data-i18n="save">Kaydet</span>
                </button>
                <button class="gm-pill-btn" id="exportBtn">
                    <i class="fas fa-download"></i> <span data-i18n="export">Export</span>
                </button>
                <div class="gm-divider-v" style="width:1px; height:20px; background:var(--gm-divider); margin:0 8px;">
                </div>
                <button id="themeToggle" class="gm-pill-btn"><i class="fas fa-moon"></i> / <i
                        class="fas fa-sun"></i></button>
                <button id="langToggle" class="gm-pill-btn"><span id="langLabel">🇹🇷 Tr | En</span></button>
            </div>
        </header>

        <main class="viz-main">
            <!-- SOL PANEL: VERİ SÜTUNLARI -->
            <section class="viz-left-pane" style="max-height: calc(100vh - 80px); overflow-y: auto;">
                <div class="gm-card viz-data-card">
                    <div class="viz-data-header">
                        <h3><i class="fas fa-database"></i> <span data-i18n="data_columns">Veri Sütunları</span></h3>
                        <button class="gm-pill-btn viz-load-btn" id="loadDataBtn">
                            <i class="fas fa-folder-open"></i>
                        </button>
                    </div>

                    <!-- Dosya Yükleme -->
                    <div class="viz-file-drop" id="vizDropZone">
                        <i class="fas fa-file-excel"></i>
                        <span data-i18n="drop_excel">Excel dosyası sürükleyin</span>
                        <input type="file" id="vizFileInput" accept=".xlsx,.xls,.csv" style="display:none;">
                        <div class="viz-file-types">
                            <i class="fas fa-info-circle"></i>
                            <span data-i18n="supported_files">.xlsx, .xls, .csv dosyaları desteklenir</span>
                        </div>
                    </div>

                    <!-- Yüklenen Dosya Bilgisi -->
                    <div class="viz-file-info" id="vizFileInfo" style="display:none;">
                        <div class="viz-file-name">
                            <i class="fas fa-file-excel"></i>
                            <span id="vizFileName"></span>
                            <button class="viz-file-remove" id="vizFileRemove"><i class="fas fa-times"></i></button>
                        </div>

                        <!-- Sayfa ve Başlık Satırı Seçicileri - Yan Yana -->
                        <div class="viz-file-options" id="vizFileOptions" style="display:none;">
                            <!-- Yan yana layout konteyner -->
                            <div class="viz-selectors-row">
                                <!-- Sayfa Seçici (Çok Sayfalı Excel İçin) -->
                                <div class="viz-selector-item" id="vizSheetSelectorWrapper" style="display:none;">
                                    <label class="viz-selector-label">
                                        <i class="fas fa-layer-group"></i>
                                        <span data-i18n="select_sheet">Sayfa Seç</span>
                                    </label>
                                    <select id="vizSheetSelector" class="viz-selector-dropdown">
                                        <option value="">Sayfa seçin...</option>
                                    </select>
                                </div>

                                <!-- Başlık Satırı Seçici -->
                                <div class="viz-selector-item">
                                    <label class="viz-selector-label">
                                        <i class="fas fa-heading"></i>
                                        <span data-i18n="header_row">Başlık Satırı</span>
                                    </label>
                                    <select id="vizHeaderRow" class="viz-selector-dropdown">
                                        <option value="0" data-i18n="row_1">1. Satır</option>
                                        <option value="1" data-i18n="row_2">2. Satır</option>
                                        <option value="2" data-i18n="row_3">3. Satır</option>
                                        <option value="3" data-i18n="row_4">4. Satır</option>
                                        <option value="4" data-i18n="row_5">5. Satır</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Dosyayı Önizle Butonu -->
                            <button type="button" class="viz-preview-btn" onclick="showHeaderPreview()">
                                <i class="fas fa-table"></i>
                                <span data-i18n="preview_file">Dosyayı Önizle</span>
                            </button>
                        </div>
                    </div>


                    <!-- Sütun Listesi (Sürüklenebilir) - 5 sütun gösterecek şekilde -->
                    <div class="viz-columns-list" id="vizColumnsList" style="min-height:180px; max-height:200px;">
                        <div class="viz-no-data" data-i18n="no_data_loaded">
                            <i class="fas fa-info-circle"></i>
                            Veri yükleyin
                        </div>
                    </div>

                    <!-- TAM VERİ PROFİLİ (Sağ bardan taşındı) -->
                    <div class="viz-data-profile-full" id="vizDataProfileFull" style="display:none;">
                        <h4><i class="fas fa-database"></i> <span data-i18n="data_profile">Veri Profili</span></h4>

                        <!-- Genel Bilgi -->
                        <div class="viz-profile-summary-left">
                            <div class="viz-profile-stat-left">
                                <span class="viz-profile-value-left" id="vizRowCountFull">0</span>
                                <span class="viz-profile-label-left" data-i18n="total_rows">Satır</span>
                            </div>
                            <div class="viz-profile-stat-left">
                                <span class="viz-profile-value-left" id="vizColCountFull">0</span>
                                <span class="viz-profile-label-left" data-i18n="total_columns">Sütun</span>
                            </div>
                            <div class="viz-profile-stat-left">
                                <span class="viz-profile-value-left" id="vizQualityFull">0%</span>
                                <span class="viz-profile-label-left" data-i18n="data_quality">Kalite</span>
                            </div>
                        </div>

                        <!-- Sütun Tipleri -->
                        <div class="viz-column-types-left" id="columnTypesLeft"></div>

                        <!-- Eksik Değerler -->
                        <div class="viz-missing-values-left">
                            <div class="viz-missing-header-left">
                                <i class="fas fa-exclamation-circle"></i>
                                <span data-i18n="missing_values">Eksik Değerler</span>
                            </div>
                            <div class="viz-missing-list-left" id="missingValuesListLeft"></div>
                        </div>
                    </div>

                    <!-- Grafik Tipleri -->
                    <div class="viz-chart-types">
                        <h4><i class="fas fa-chart-pie"></i> <span data-i18n="chart_types">Grafik Tipleri</span></h4>

                        <!-- Temel Grafikler -->
                        <div class="viz-chart-category">
                            <span class="viz-category-label" data-i18n="basic_charts">Temel</span>
                        </div>
                        <div class="viz-chart-grid">
                            <div class="viz-chart-type" data-type="bar" draggable="true">
                                <i class="fas fa-chart-bar"></i>
                                <span data-i18n="chart_bar">Sütun</span>
                            </div>
                            <div class="viz-chart-type" data-type="line" draggable="true">
                                <i class="fas fa-chart-line"></i>
                                <span data-i18n="chart_line">Çizgi</span>
                            </div>
                            <div class="viz-chart-type" data-type="pie" draggable="true">
                                <i class="fas fa-chart-pie"></i>
                                <span data-i18n="chart_pie">Pasta</span>
                            </div>
                            <div class="viz-chart-type" data-type="area" draggable="true">
                                <i class="fas fa-chart-area"></i>
                                <span data-i18n="chart_area">Alan</span>
                            </div>
                            <div class="viz-chart-type" data-type="scatter" draggable="true">
                                <i class="fas fa-braille"></i>
                                <span data-i18n="chart_scatter">Dağılım</span>
                            </div>
                            <div class="viz-chart-type" data-type="doughnut" draggable="true">
                                <i class="fas fa-circle-notch"></i>
                                <span data-i18n="chart_doughnut">Halka</span>
                            </div>
                        </div>

                        <!-- İleri Grafikler -->
                        <div class="viz-chart-category">
                            <span class="viz-category-label" data-i18n="advanced_charts">İleri</span>
                        </div>
                        <div class="viz-chart-grid">
                            <div class="viz-chart-type viz-chart-advanced" data-type="dual-axis" draggable="true">
                                <i class="fas fa-layer-group"></i>
                                <span data-i18n="chart_dual_axis">Dual-Axis</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="stacked-bar" draggable="true">
                                <i class="fas fa-align-left fa-rotate-90"></i>
                                <span data-i18n="chart_stacked">Yığın</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="treemap" draggable="true">
                                <i class="fas fa-th"></i>
                                <span data-i18n="chart_treemap">Treemap</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="heatmap" draggable="true">
                                <i class="fas fa-fire"></i>
                                <span data-i18n="chart_heatmap">Isı Haritası</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="funnel" draggable="true">
                                <i class="fas fa-filter"></i>
                                <span data-i18n="chart_funnel">Huni</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="gauge" draggable="true">
                                <i class="fas fa-tachometer-alt"></i>
                                <span data-i18n="chart_gauge">Gösterge</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="waterfall" draggable="true">
                                <i class="fas fa-water"></i>
                                <span data-i18n="chart_waterfall">Şelale</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="radar" draggable="true">
                                <i class="fas fa-spider"></i>
                                <span data-i18n="chart_radar">Radar</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="boxplot" draggable="true">
                                <i class="fas fa-square"></i>
                                <span data-i18n="chart_boxplot">Kutu</span>
                            </div>
                            <div class="viz-chart-type viz-chart-advanced" data-type="pareto" draggable="true">
                                <i class="fas fa-sort-amount-down"></i>
                                <span data-i18n="chart_pareto">Pareto</span>
                            </div>
                        </div>

                        <!-- 3D Grafikler -->
                        <div class="viz-chart-category">
                            <span class="viz-category-label" data-i18n="3d_charts">3D</span>
                        </div>
                        <div class="viz-chart-grid">
                            <div class="viz-chart-type viz-chart-3d" data-type="scatter3d" draggable="true">
                                <i class="fas fa-cube"></i>
                                <span data-i18n="chart_scatter3d">3D Dağılım</span>
                            </div>
                            <div class="viz-chart-type viz-chart-3d" data-type="bar3d" draggable="true">
                                <i class="fas fa-cubes"></i>
                                <span data-i18n="chart_bar3d">3D Sütun</span>
                            </div>
                            <div class="viz-chart-type viz-chart-3d" data-type="surface3d" draggable="true">
                                <i class="fas fa-mountain"></i>
                                <span data-i18n="chart_surface3d">3D Yüzey</span>
                            </div>
                            <div class="viz-chart-type viz-chart-3d" data-type="line3d" draggable="true">
                                <i class="fas fa-project-diagram"></i>
                                <span data-i18n="chart_line3d">3D Çizgi</span>
                            </div>
                        </div>

                        <!-- Yeni Grafikler (Sprint 3-8) -->
                        <div class="viz-chart-category">
                            <span class="viz-category-label" data-i18n="special_charts">Özel Grafikler</span>
                        </div>
                        <div class="viz-chart-grid">
                            <div class="viz-chart-type" data-type="histogram" draggable="true">
                                <i class="fas fa-signal"></i>
                                <span data-i18n="chart_histogram">Histogram</span>
                            </div>
                            <div class="viz-chart-type" data-type="bubble" draggable="true">
                                <i class="fas fa-circle"></i>
                                <span data-i18n="chart_bubble">Bubble</span>
                            </div>
                            <div class="viz-chart-type" data-type="sankey" draggable="true">
                                <i class="fas fa-wave-square"></i>
                                <span data-i18n="chart_sankey">Sankey</span>
                            </div>
                            <div class="viz-chart-type" data-type="sunburst" draggable="true">
                                <i class="fas fa-sun"></i>
                                <span data-i18n="chart_sunburst">Sunburst</span>
                            </div>
                            <div class="viz-chart-type" data-type="polar" draggable="true">
                                <i class="fas fa-bullseye"></i>
                                <span data-i18n="chart_polar">Polar</span>
                            </div>
                            <div class="viz-chart-type" data-type="lollipop" draggable="true">
                                <i class="fas fa-grip-lines-vertical"></i>
                                <span data-i18n="chart_lollipop">Lollipop</span>
                            </div>
                            <div class="viz-chart-type" data-type="bullet" draggable="true">
                                <i class="fas fa-thermometer-half"></i>
                                <span data-i18n="chart_bullet">Bullet</span>
                            </div>
                            <div class="viz-chart-type" data-type="step" draggable="true">
                                <i class="fas fa-stairs"></i>
                                <span data-i18n="chart_step">Step Line</span>
                            </div>
                            <div class="viz-chart-type" data-type="calendar" draggable="true">
                                <i class="fas fa-calendar-alt"></i>
                                <span data-i18n="chart_calendar">Takvim</span>
                            </div>
                            <div class="viz-chart-type" data-type="candlestick" draggable="true">
                                <i class="fas fa-chart-candlestick"></i>
                                <span data-i18n="chart_candlestick">Mum</span>
                            </div>
                            <div class="viz-chart-type" data-type="violin" draggable="true">
                                <i class="fas fa-guitar"></i>
                                <span data-i18n="chart_violin">Violin</span>
                            </div>
                            <div class="viz-chart-type" data-type="gantt" draggable="true">
                                <i class="fas fa-tasks"></i>
                                <span data-i18n="chart_gantt">Gantt</span>
                            </div>
                            <div class="viz-chart-type" data-type="grouped-bar" draggable="true">
                                <i class="fas fa-align-left"></i>
                                <span data-i18n="chart_grouped_bar">Gruplu Bar</span>
                            </div>
                            <div class="viz-chart-type" data-type="word-cloud" draggable="true">
                                <i class="fas fa-cloud"></i>
                                <span data-i18n="chart_word_cloud">Kelime Bulutu</span>
                            </div>
                            <div class="viz-chart-type" data-type="timeline" draggable="true">
                                <i class="fas fa-stream"></i>
                                <span data-i18n="chart_timeline">Timeline</span>
                            </div>
                            <div class="viz-chart-type" data-type="chord" draggable="true">
                                <i class="fas fa-project-diagram"></i>
                                <span data-i18n="chart_chord">Chord</span>
                            </div>
                            <div class="viz-chart-type" data-type="parallel" draggable="true">
                                <i class="fas fa-bars"></i>
                                <span data-i18n="chart_parallel">Parallel</span>
                            </div>
                            <div class="viz-chart-type" data-type="range-area" draggable="true">
                                <i class="fas fa-chart-area"></i>
                                <span data-i18n="chart_range_area">Range Area</span>
                            </div>
                            <div class="viz-chart-type" data-type="density" draggable="true">
                                <i class="fas fa-wave-square"></i>
                                <span data-i18n="chart_density">Yoğunluk</span>
                            </div>
                        </div>
                    </div>

                    <div class="viz-chart-category">
                        <span class="viz-category-label" data-i18n="statistics">İstatistik Analizleri</span>
                        <span class="viz-drag-hint" data-i18n="drag_to_dashboard">🎯 Dashboard'a sürükle</span>
                    </div>
                    <div class="viz-stat-buttons">
                        <!-- Parametrik Testler -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="ttest">
                            <i class="fas fa-balance-scale"></i> <span data-i18n="stat_ttest">t-Test</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="anova">
                            <i class="fas fa-chart-bar"></i> <span data-i18n="stat_anova">ANOVA</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="chi-square">
                            <i class="fas fa-th"></i> <span data-i18n="stat_chi">Chi²</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="correlation">
                            <i class="fas fa-project-diagram"></i> <span data-i18n="stat_correlation">Korelasyon</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="normality">
                            <i class="fas fa-bell"></i> <span data-i18n="stat_normality">Normallik</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="descriptive">
                            <i class="fas fa-calculator"></i> <span data-i18n="stat_descriptive">Betimsel</span>
                        </button>

                        <!-- Non-Parametrik Testler -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="mann-whitney">
                            <i class="fas fa-random"></i> <span data-i18n="stat_mannwhitney">Mann-Whitney</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="wilcoxon">
                            <i class="fas fa-exchange-alt"></i> <span data-i18n="stat_wilcoxon">Wilcoxon</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="kruskal">
                            <i class="fas fa-layer-group"></i> <span data-i18n="stat_kruskal">Kruskal-Wallis</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="levene">
                            <i class="fas fa-balance-scale-right"></i> <span data-i18n="stat_levene">Levene</span>
                        </button>

                        <!-- Effect Size & Frequency -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="effect-size">
                            <i class="fas fa-ruler"></i> <span data-i18n="stat_effect_size">Effect Size</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="frequency">
                            <i class="fas fa-list-ol"></i> <span data-i18n="stat_frequency">Frekans</span>
                        </button>

                        <!-- İleri Analizler -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="pca"
                            onclick="showPCAModal && showPCAModal()">
                            <i class="fas fa-compress-arrows-alt"></i> <span data-i18n="stat_pca">PCA</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="kmeans"
                            onclick="showClusterModal && showClusterModal()">
                            <i class="fas fa-object-group"></i> <span data-i18n="stat_kmeans">K-Means</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="cronbach"
                            onclick="showCronbachModal && showCronbachModal()">
                            <i class="fas fa-check-double"></i> <span data-i18n="stat_cronbach">Cronbach α</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="logistic"
                            onclick="showLogisticModal && showLogisticModal()">
                            <i class="fas fa-divide"></i> <span data-i18n="stat_logistic">Lojistik Reg.</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="timeseries"
                            onclick="showTimeSeriesModal && showTimeSeriesModal()">
                            <i class="fas fa-clock"></i> <span data-i18n="stat_timeseries">Zaman Serisi</span>
                        </button>

                        <!-- Rapor -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="apa"
                            onclick="generateAPAReport && generateAPAReport()">
                            <i class="fas fa-file-alt"></i> <span data-i18n="stat_apa">APA Raporu</span>
                        </button>

                        <!-- Sprint 12: Yeni İstatistik Testleri -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="friedman"
                            onclick="showFriedmanModal && showFriedmanModal()">
                            <i class="fas fa-grip-horizontal"></i> <span data-i18n="stat_friedman">Friedman</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="power"
                            onclick="showPowerAnalysisModal && showPowerAnalysisModal()">
                            <i class="fas fa-bolt"></i> <span data-i18n="stat_power">Power Analysis</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true"
                            data-stat-type="regression-coef" onclick="showRegressionModal && showRegressionModal()">
                            <i class="fas fa-chart-line"></i> <span data-i18n="stat_regression">Regresyon</span>
                        </button>

                        <!-- Sprint 13: İleri Analizler -->
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="discriminant"
                            onclick="showDiscriminantModal && showDiscriminantModal()">
                            <i class="fas fa-crosshairs"></i> <span data-i18n="stat_discriminant">Discriminant</span>
                        </button>
                        <button class="viz-stat-btn viz-stat-draggable" draggable="true" data-stat-type="survival"
                            onclick="showSurvivalModal && showSurvivalModal()">
                            <i class="fas fa-heartbeat"></i> <span data-i18n="stat_survival">Sağkalım</span>
                        </button>
                    </div>

                    <!-- Harita/Coğrafi Grafikler -->
                    <div class="viz-chart-category">
                        <span class="viz-category-label" data-i18n="map_charts">Harita Grafikleri</span>
                    </div>
                    <div class="viz-chart-grid">
                        <div class="viz-chart-type viz-chart-map" data-type="choropleth" draggable="true">
                            <i class="fas fa-map"></i>
                            <span>Choropleth</span>
                        </div>
                        <div class="viz-chart-type viz-chart-map" data-type="bubble-map" draggable="true">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Bubble Map</span>
                        </div>
                        <div class="viz-chart-type viz-chart-map" data-type="flow-map" draggable="true">
                            <i class="fas fa-route"></i>
                            <span>Flow Map</span>
                        </div>
                        <div class="viz-chart-type viz-chart-map" data-type="geo-heatmap" draggable="true">
                            <i class="fas fa-globe"></i>
                            <span>Geo Heatmap</span>
                        </div>
                        <div class="viz-chart-type viz-chart-map" data-type="point-map" draggable="true">
                            <i class="fas fa-thumbtack"></i>
                            <span>Point Map</span>
                        </div>
                    </div>

                    <!-- Veri Yönetimi - TAM LİSTE -->
                    <div class="viz-chart-category">
                        <span class="viz-category-label" data-i18n="data_management">Veri Yönetimi</span>
                    </div>
                    <div class="viz-data-actions">
                        <!-- Temel -->
                        <button class="viz-action-btn" onclick="showFilterPanel && showFilterPanel()">
                            <i class="fas fa-filter"></i> <span data-i18n="action_filter">Filtrele</span>
                        </button>
                        <button class="viz-action-btn" onclick="showSortPanel && showSortPanel()">
                            <i class="fas fa-sort"></i> <span data-i18n="action_sort">Sırala</span>
                        </button>
                        <button class="viz-action-btn" onclick="showDataProfileModal && showDataProfileModal()">
                            <i class="fas fa-info-circle"></i> <span data-i18n="action_profile">Profil</span>
                        </button>
                        <button class="viz-action-btn" onclick="undo && undo()">
                            <i class="fas fa-undo"></i> <span data-i18n="action_undo">Geri Al</span>
                        </button>
                        <button class="viz-action-btn" onclick="redo && redo()">
                            <i class="fas fa-redo"></i> <span data-i18n="action_redo">İleri Al</span>
                        </button>

                        <!-- Temizleme -->
                        <button class="viz-action-btn" onclick="showFillMissingModal && showFillMissingModal()">
                            <i class="fas fa-fill-drip"></i> <span data-i18n="action_fill_missing">Eksik Doldur</span>
                        </button>
                        <button class="viz-action-btn" onclick="showOutlierModal && showOutlierModal()">
                            <i class="fas fa-exclamation-triangle"></i> <span data-i18n="action_remove_outliers">Aykırı
                                Temizle</span>
                        </button>
                        <button class="viz-action-btn" onclick="showDuplicateModal && showDuplicateModal()">
                            <i class="fas fa-copy"></i> <span data-i18n="action_remove_duplicates">Kopyaları Sil</span>
                        </button>

                        <!-- Dönüştürme -->
                        <button class="viz-action-btn" onclick="showTypeConvertModal && showTypeConvertModal()">
                            <i class="fas fa-exchange-alt"></i> <span data-i18n="action_convert_type">Tip
                                Dönüştür</span>
                        </button>
                        <button class="viz-action-btn" onclick="showMergeColumnsModal && showMergeColumnsModal()">
                            <i class="fas fa-columns"></i> <span data-i18n="action_merge_columns">Kolon Birleştir</span>
                        </button>
                        <button class="viz-action-btn" onclick="showSplitColumnModal && showSplitColumnModal()">
                            <i class="fas fa-cut"></i> <span data-i18n="action_split_column">Kolon Böl</span>
                        </button>
                        <button class="viz-action-btn" onclick="showFindReplaceModal && showFindReplaceModal()">
                            <i class="fas fa-search"></i> <span data-i18n="action_find_replace">Bul/Değiştir</span>
                        </button>

                        <!-- İleri -->
                        <button class="viz-action-btn" onclick="showBinningModal && showBinningModal()">
                            <i class="fas fa-cut"></i> <span data-i18n="action_binning">Binning</span>
                        </button>
                        <button class="viz-action-btn" onclick="showPivotModal && showPivotModal()">
                            <i class="fas fa-table"></i> <span data-i18n="action_pivot">Pivot</span>
                        </button>
                        <button class="viz-action-btn"
                            onclick="showCalculatedColumnModal && showCalculatedColumnModal()">
                            <i class="fas fa-plus-circle"></i> <span data-i18n="action_calculated">Hesaplanan</span>
                        </button>

                        <!-- Yükleme -->
                        <button class="viz-action-btn" onclick="showURLLoadModal && showURLLoadModal()">
                            <i class="fas fa-link"></i> <span data-i18n="action_load_url">URL'den Yükle</span>
                        </button>
                        <button class="viz-action-btn"
                            onclick="loadMultipleFiles && document.getElementById('vizFileInput').click()">
                            <i class="fas fa-plus"></i> <span data-i18n="action_add_file">Dosya Ekle</span>
                        </button>
                    </div>

                    <!-- Sprint 13: Araçlar & Yardım -->
                    <div class="viz-chart-category">
                        <span class="viz-category-label" data-i18n="tools_category">Araçlar</span>
                    </div>
                    <div class="viz-data-actions">
                        <button class="viz-action-btn" onclick="showWatermarkModal && showWatermarkModal()">
                            <i class="fas fa-tint"></i> <span data-i18n="tool_watermark">Watermark</span>
                        </button>
                        <button class="viz-action-btn"
                            onclick="showReportCustomizationModal && showReportCustomizationModal()">
                            <i class="fas fa-file-pdf"></i> <span data-i18n="tool_report_settings">Rapor Ayarları</span>
                        </button>
                        <button class="viz-action-btn" onclick="showVideoHelpModal && showVideoHelpModal()">
                            <i class="fas fa-video"></i> <span data-i18n="tool_video_help">Video Yardım</span>
                        </button>
                        <button class="viz-action-btn" onclick="exportWithAnnotations && exportWithAnnotations()">
                            <i class="fas fa-pencil-alt"></i> <span data-i18n="tool_export_annotated">Notlu
                                Export</span>
                        </button>
                    </div>
                </div>

            </section>

            <!-- ORTA PANEL: CANLI DASHBOARD -->
            <section class="viz-middle-pane">
                <div class="viz-canvas-header">
                    <h2><i class="fas fa-th-large"></i> <span data-i18n="dashboard">Dashboard</span></h2>
                    <div class="viz-canvas-actions">
                        <span class="viz-live-badge">
                            <i class="fas fa-circle"></i> <span data-i18n="live">CANLI</span>
                        </span>
                        <button class="gm-pill-btn" id="addChartBtn">
                            <i class="fas fa-plus"></i> <span data-i18n="add_chart">Grafik Ekle</span>
                        </button>
                        <button class="gm-pill-btn" id="clearCanvasBtn">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>

                <!-- Dashboard Grid -->
                <div class="viz-dashboard-grid" id="vizDashboardGrid">
                    <!-- Boş durum -->
                    <div class="viz-empty-canvas" id="vizEmptyCanvas">
                        <i class="fas fa-chart-line"></i>
                        <h3 data-i18n="empty_dashboard_title">Dashboard'unuz Boş</h3>
                        <p data-i18n="empty_dashboard_desc">Sol taraftan grafik tipini sürükleyin veya "Grafik Ekle"
                            butonuna
                            tıklayın</p>
                    </div>
                </div>
            </section>

            <!-- SAĞ PANEL: GRAFİK AYARLARI -->
            <section class="viz-right-pane" id="vizSettingsPane">
                <div class="gm-card viz-settings-card">
                    <div class="viz-settings-header">
                        <h3><i class="fas fa-cog"></i> <span data-i18n="chart_settings">Grafik Ayarları</span></h3>
                        <button class="gm-pill-btn viz-settings-close" id="closeSettingsBtn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Grafik seçili değilken -->
                    <div class="viz-no-selection" id="vizNoSelection">
                        <i class="fas fa-mouse-pointer"></i>
                        <p data-i18n="select_chart">Düzenlemek için bir grafik seçin</p>
                    </div>

                    <!-- Grafik ayarları formu -->
                    <div class="viz-settings-form" id="vizSettingsForm" style="display:none;">
                        <!-- Grafik Başlığı -->
                        <div class="viz-form-group">
                            <label data-i18n="chart_title">Grafik Başlığı</label>
                            <input type="text" id="chartTitle" placeholder="Başlık...">
                        </div>

                        <!-- X Ekseni (Scatter için çoklu, diğerleri için tekli) -->
                        <div class="viz-form-group">
                            <label data-i18n="x_axis">X Ekseni (Kategori)</label>
                            <select id="chartXAxis" size="1">
                                <option value="">Seçin...</option>
                            </select>
                            <small class="viz-hint viz-scatter-hint" id="scatterXHint" style="display:none;"
                                data-i18n="scatter_x_hint">Scatter için çoklu X seçimi aktif</small>
                        </div>

                        <!-- Y Ekseni (Çoklu Seçim) -->
                        <div class="viz-form-group">
                            <label data-i18n="y_axes">Y Eksenleri (Değerler)</label>
                            <select id="chartYAxis" multiple size="3">
                                <option value="">Seçin...</option>
                            </select>
                            <small class="viz-hint" data-i18n="multi_select_hint">Ctrl+Click ile çoklu seçim</small>
                        </div>

                        <!-- Dual Axis (Sağ Eksen) -->
                        <div class="viz-form-group viz-dual-axis-group" id="dualAxisGroup">
                            <div class="viz-dual-toggle">
                                <label class="viz-checkbox">
                                    <input type="checkbox" id="useDualAxis">
                                    <span data-i18n="use_right_axis">İkinci seriyi sağ eksende göster</span>
                                </label>
                            </div>
                            <div id="y2AxisWrapper" style="display:none; margin-top:8px;">
                                <label style="font-size:0.8rem;" data-i18n="right_axis_column">Sağ Eksen Sütunu</label>
                                <select id="chartY2Axis">
                                    <option value="">Otomatik (seçilen 2. sütun)</option>
                                </select>
                            </div>
                        </div>

                        <!-- Agregasyon -->
                        <div class="viz-form-group">
                            <label data-i18n="aggregation">Agregasyon</label>
                            <select id="chartAggregation">
                                <option value="sum" data-i18n="agg_sum">Toplam</option>
                                <option value="avg" data-i18n="agg_avg">Ortalama</option>
                                <option value="count" data-i18n="agg_count">Sayı</option>
                                <option value="min" data-i18n="agg_min">Minimum</option>
                                <option value="max" data-i18n="agg_max">Maksimum</option>
                            </select>
                        </div>

                        <!-- Renk ve Görünüm -->
                        <div class="viz-form-group">
                            <label data-i18n="appearance">Görünüm</label>
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                                <div>
                                    <label style="font-size:0.8rem;">Renk</label>
                                    <div class="viz-color-picker">
                                        <input type="color" id="chartColor" value="#4a90d9">
                                    </div>
                                </div>
                                <div>
                                    <label style="font-size:0.8rem;">Şeffaflık</label>
                                    <input type="range" id="chartOpacity" min="0.1" max="1" step="0.1" value="0.8">
                                </div>
                            </div>
                        </div>

                        <!-- Veri Limiti -->
                        <div class="viz-form-group">
                            <label>Gösterilecek Değer Sayısı</label>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <input type="number" id="chartDataLimit" min="0" max="500" value="20"
                                    style="width:80px;" placeholder="20">
                                <span style="font-size:0.75rem; color:var(--gm-text-muted);">
                                    0 = Sınırsız
                                </span>
                            </div>
                        </div>

                        <!-- Font ve Stil -->
                        <div class="viz-form-group">
                            <label data-i18n="font_style">Font ve Stil</label>
                            <select id="chartFontFamily" style="margin-bottom:5px;">
                                <option value="Arial">Arial</option>
                                <option value="Verdana">Verdana</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Courier New">Courier New</option>
                                <option value="Roboto">Roboto</option>
                            </select>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <label class="viz-checkbox" style="font-size:0.8rem;">
                                    <input type="checkbox" id="chartGradient">
                                    <span>Gradient</span>
                                </label>
                                <label class="viz-checkbox" style="font-size:0.8rem;">
                                    <input type="checkbox" id="chartShadow">
                                    <span>Gölge</span>
                                </label>
                            </div>
                        </div>

                        <!-- Uygula Butonu -->
                        <button class="gm-gradient-btn" id="applySettingsBtn" style="width:100%; margin-top:15px;">
                            <i class="fas fa-check"></i> <span data-i18n="apply">Uygula</span>
                        </button>

                        <!-- Sil Butonu -->
                        <button class="gm-pill-btn viz-delete-chart" id="deleteChartBtn"
                            style="width:100%; margin-top:10px;">
                            <i class="fas fa-trash"></i> <span data-i18n="delete_chart">Grafiği Sil</span>
                        </button>

                        <!-- İstatistik Overlay Bölümü -->
                        <div class="viz-stats-section">
                            <h4><i class="fas fa-calculator"></i> <span data-i18n="stats_overlay">İstatistik
                                    Overlay</span></h4>

                            <div class="viz-stats-options">
                                <label class="viz-checkbox">
                                    <input type="checkbox" id="showMeanLine">
                                    <span data-i18n="show_mean">Ortalama Çizgisi</span>
                                </label>
                                <label class="viz-checkbox">
                                    <input type="checkbox" id="showMedianLine">
                                    <span data-i18n="show_median">Medyan Çizgisi</span>
                                </label>
                                <label class="viz-checkbox">
                                    <input type="checkbox" id="showStdBand">
                                    <span data-i18n="show_std_band">Standart Sapma Bandı (±1σ)</span>
                                </label>
                                <label class="viz-checkbox">
                                    <input type="checkbox" id="showTrendLine">
                                    <span data-i18n="show_trend">Trend Çizgisi</span>
                                </label>
                            </div>
                        </div>

                        <!-- İstatistik Özeti -->
                        <div class="viz-stats-summary" id="vizStatsSummary" style="display:none;">
                            <h4><i class="fas fa-chart-bar"></i> <span data-i18n="stats_summary">İstatistik Özeti</span>
                            </h4>
                            <div class="viz-stats-grid">
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_mean">Ortalama</span>
                                    <span class="viz-stat-value" id="statMean">-</span>
                                </div>
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_median">Medyan</span>
                                    <span class="viz-stat-value" id="statMedian">-</span>
                                </div>
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_stdev">Std Sapma</span>
                                    <span class="viz-stat-value" id="statStdev">-</span>
                                </div>
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_min">Min</span>
                                    <span class="viz-stat-value" id="statMin">-</span>
                                </div>
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_max">Maks</span>
                                    <span class="viz-stat-value" id="statMax">-</span>
                                </div>
                                <div class="viz-stat-item">
                                    <span class="viz-stat-label" data-i18n="stat_count">Sayı</span>
                                    <span class="viz-stat-value" id="statCount">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- İstatistiksel Analiz Bölümü (Faz 5) -->
                        <div class="viz-spss-section viz-accordion-section">
                            <div class="viz-accordion-header" onclick="toggleAccordion(this)">
                                <h4><i class="fas fa-flask"></i> <span data-i18n="statistical_analysis">İstatistiksel
                                        Analiz</span></h4>
                                <i class="fas fa-chevron-down viz-accordion-icon"></i>
                            </div>
                            <div class="viz-accordion-content">

                                <!-- Regresyon Tipi -->
                                <div class="viz-form-group">
                                    <label data-i18n="regression_type">Regresyon Tipi</label>
                                    <select id="regressionType">
                                        <option value="none" data-i18n="reg_none">Yok</option>
                                        <option value="linear" data-i18n="reg_linear">Doğrusal</option>
                                        <option value="polynomial" data-i18n="reg_polynomial">Polinom (2°)</option>
                                        <option value="exponential" data-i18n="reg_exponential">Üstel</option>
                                        <option value="logarithmic" data-i18n="reg_logarithmic">Logaritmik</option>
                                    </select>
                                </div>

                                <!-- Regresyon Sonuçları -->
                                <div class="viz-regression-results" id="regressionResults" style="display:none;">
                                    <div class="viz-stat-item">
                                        <span class="viz-stat-label">R²</span>
                                        <span class="viz-stat-value" id="rSquared">-</span>
                                    </div>
                                    <div class="viz-stat-item">
                                        <span class="viz-stat-label" data-i18n="equation">Denklem</span>
                                        <span class="viz-stat-value viz-equation" id="regressionEquation">-</span>
                                    </div>
                                </div>

                                <!-- İstatistik Testler -->
                                <div class="viz-stat-tests">
                                    <button class="viz-test-btn" onclick="runStatTest('ttest')">
                                        <i class="fas fa-balance-scale"></i> t-Test
                                    </button>
                                    <button class="viz-test-btn" onclick="runStatTest('anova')">
                                        <i class="fas fa-chart-bar"></i> ANOVA
                                    </button>
                                    <button class="viz-test-btn" onclick="runStatTest('correlation')">
                                        <i class="fas fa-project-diagram"></i> Korelasyon
                                    </button>
                                    <button class="viz-test-btn" onclick="runStatTest('normality')">
                                        <i class="fas fa-bell"></i> Normallik
                                    </button>
                                </div>

                                <!-- Test Sonuçları -->
                                <div class="viz-test-results" id="testResults" style="display:none;">
                                    <div class="viz-test-result-header">
                                        <span id="testName">-</span>
                                        <span class="viz-p-value" id="testPValue">p = -</span>
                                    </div>
                                    <div class="viz-test-result-body" id="testResultBody">-</div>
                                </div>
                            </div>

                            <!-- BI Insights Bölümü (Faz 6) -->
                            <div class="viz-bi-section">
                                <h4><i class="fas fa-brain"></i> <span data-i18n="bi_insights">BI Insights</span></h4>

                                <!-- Cross-Filter Toggle -->
                                <label class="viz-checkbox viz-cross-filter">
                                    <input type="checkbox" id="crossFilterEnabled">
                                    <span data-i18n="cross_filter">Cross-Filter Aktif</span>
                                    <i class="fas fa-link" style="margin-left:auto; color:var(--gm-primary);"></i>
                                </label>

                                <!-- What-If Simulator -->
                                <div class="viz-whatif-section">
                                    <label data-i18n="whatif_title">What-If Simulator</label>
                                    <div class="viz-whatif-slider">
                                        <span class="viz-slider-label">-50%</span>
                                        <input type="range" id="whatIfSlider" min="-50" max="50" value="0">
                                        <span class="viz-slider-label">+50%</span>
                                    </div>
                                    <div class="viz-whatif-value">
                                        <span data-i18n="change_rate">Değişim:</span>
                                        <span id="whatIfValue" class="viz-whatif-percent">0%</span>
                                    </div>
                                </div>

                                <!-- Anomaly Detection -->
                                <div class="viz-anomaly-section">
                                    <button class="viz-test-btn viz-anomaly-btn" onclick="detectAnomalies()">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <span data-i18n="detect_anomalies">Anomali Tespit</span>
                                    </button>
                                    <div class="viz-anomaly-results" id="anomalyResults" style="display:none;">
                                        <div class="viz-anomaly-count">
                                            <span id="anomalyCount">0</span>
                                            <small data-i18n="anomalies_found">anomali bulundu</small>
                                        </div>
                                        <div class="viz-anomaly-list" id="anomalyList"></div>
                                    </div>
                                </div>

                                <!-- Trend Insight -->
                                <div class="viz-trend-insight" id="trendInsight" style="display:none;">
                                    <i class="fas fa-chart-line"></i>
                                    <span id="trendText">-</span>
                                </div>
                            </div>

                            <!-- Veri Profili Bölümü (Faz 7) -->
                            <div class="viz-data-profile-section">
                                <h4><i class="fas fa-database"></i> <span data-i18n="data_profile">Veri Profili</span>
                                </h4>

                                <!-- Profil Butonu -->
                                <button class="viz-test-btn viz-profile-btn" onclick="runDataProfile()">
                                    <i class="fas fa-microscope"></i>
                                    <span data-i18n="analyze_data">Veri Analizi</span>
                                </button>

                                <!-- Profil Sonuçları -->
                                <div class="viz-profile-results" id="profileResults" style="display:none;">
                                    <!-- Genel Bilgi -->
                                    <div class="viz-profile-summary">
                                        <div class="viz-profile-stat">
                                            <span class="viz-profile-value" id="profileRows">0</span>
                                            <span class="viz-profile-label" data-i18n="total_rows">Satır</span>
                                        </div>
                                        <div class="viz-profile-stat">
                                            <span class="viz-profile-value" id="profileCols">0</span>
                                            <span class="viz-profile-label" data-i18n="total_cols">Sütun</span>
                                        </div>
                                        <div class="viz-profile-stat">
                                            <span class="viz-profile-value" id="profileQuality">0%</span>
                                            <span class="viz-profile-label" data-i18n="data_quality">Kalite</span>
                                        </div>
                                    </div>

                                    <!-- Sütun Tipleri -->
                                    <div class="viz-column-types" id="columnTypes"></div>

                                    <!-- Eksik Değerler -->
                                    <div class="viz-missing-values">
                                        <div class="viz-missing-header">
                                            <i class="fas fa-exclamation-circle"></i>
                                            <span data-i18n="missing_values">Eksik Değerler</span>
                                        </div>
                                        <div class="viz-missing-list" id="missingValuesList"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            </section>
        </main>




        <!-- Command Palette Modal (Faz 8) -->
        <div id="commandPalette" class="viz-palette-overlay" style="display:none;">
            <div class="viz-palette">
                <div class="viz-palette-header">
                    <i class="fas fa-terminal"></i>
                    <input type="text" id="paletteSearch" placeholder="Komut ara... (ESC ile kapat)" autofocus>
                </div>
                <div class="viz-palette-commands" id="paletteCommands">
                    <!-- Commands rendered by JS -->
                </div>
                <div class="viz-palette-footer">
                    <span><kbd>↑</kbd><kbd>↓</kbd> Gezin</span>
                    <span><kbd>Enter</kbd> Çalıştır</span>
                    <span><kbd>ESC</kbd> Kapat</span>
                </div>
            </div>
        </div>

        <!-- Contact Modal (Mevcut yapıdan) -->
        <!-- PDF Preview Modal -->
        <div id="pdfPreviewModal" class="gm-modal" style="display:none;">
            <div class="gm-modal-content" style="max-width:900px; max-height:90vh;">
                <span class="gm-close-modal" onclick="closePDFPreviewModal()">&times;</span>
                <div style="padding:20px;">
                    <h2 style="margin-bottom:15px; display:flex; align-items:center; gap:10px;">
                        <i class="fas fa-file-pdf" style="color:#e74c3c;"></i>
                        <span data-i18n="pdf_preview">PDF Önizleme</span>
                    </h2>
                    <div id="pdfPreviewContainer" style="background:#f5f5f5; border-radius:8px; overflow:hidden;">
                        <iframe id="pdfPreviewIframe" style="width:100%; height:60vh; border:none;"></iframe>
                    </div>
                    <div style="margin-top:15px; display:flex; gap:10px; justify-content:flex-end;">
                        <button class="gm-gradient-btn" onclick="downloadPDFFromPreview()">
                            <i class="fas fa-download"></i> <span data-i18n="download_pdf">PDF İndir</span>
                        </button>
                        <button class="gm-pill-btn" onclick="closePDFPreviewModal()">
                            <span data-i18n="close">Kapat</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div id="contactModal" class="gm-modal">

            <div class="gm-modal-content">
                <span class="gm-close-modal">&times;</span>
                <div class="gm-modal-left">
                    <h2 data-i18n="modal_about_title">Hakkımızda</h2>
                    <p data-i18n="modal_about_desc">Opradox Visual Studio ile verilerinizi görselleştirin.</p>
                </div>
                <div class="gm-modal-right">
                    <h2 data-i18n="contact_modal_title" style="color:var(--gm-text); margin-bottom:15px; border:none;">
                        Bize
                        Ulaşın</h2>
                    <form id="contactForm">
                        <div class="gm-form-row">
                            <label data-i18n="lbl_name">Ad Soyad</label>
                            <input type="text" id="contactName" required>
                        </div>
                        <div class="gm-form-row">
                            <label data-i18n="lbl_email">E-posta</label>
                            <input type="email" id="contactEmail" required>
                        </div>
                        <div class="gm-form-row">
                            <label data-i18n="lbl_msg">Mesajınız</label>
                            <textarea id="contactMessage" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="gm-gradient-btn" style="width:100%"
                            data-i18n="send_btn">Gönder</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- FILE PREVIEW MODAL (Header Row Selection) -->
        <div id="vizFilePreviewModal" class="gm-modal">
            <div class="gm-modal-content"
                style="flex-direction: column; width: 80%; max-width: 900px; max-height: 85vh;">
                <div class="gm-modal-header">
                    <h3><i class="fas fa-table"></i> <span data-i18n="preview_file">Dosya Önizleme</span></h3>
                    <span class="gm-close-modal" onclick="closeVizPreviewModal()">&times;</span>
                </div>
                <div
                    style="padding: 10px 15px; border-bottom: 1px solid var(--gm-card-border); font-size: 0.85rem; color: var(--gm-text-muted);">
                    <i class="fas fa-info-circle"></i> Başlık satırını seçmek için satıra tıklayın.
                </div>
                <div style="flex: 1; overflow: auto; padding: 10px;">
                    <table id="vizPreviewTable" style="width: 100%; border-collapse: collapse; font-size: 0.8rem;">
                    </table>
                </div>
                <div style="padding: 10px 15px; border-top: 1px solid var(--gm-card-border); text-align: right;">
                    <button class="gm-pill-btn" onclick="closeVizPreviewModal()">
                        <i class="fas fa-times"></i> <span data-i18n="close">Kapat</span>
                    </button>
                </div>
            </div>
        </div>

</body>

</html>