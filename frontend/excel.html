<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8" />
    <title>Opradox ‚Äì Excel Studio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Opradox Excel Studio - 70+ senaryo ile Excel dosyalarƒ±nƒ±zƒ± i≈üleyin" />

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BVYYQS8HWY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        const hostname = window.location.hostname;
        if (hostname.includes('opradox.com.tr')) {
            gtag('config', 'G-BVYYQS8HWY');
        } else if (hostname.includes('opradox.com')) {
            gtag('config', 'G-EDHVSD1LM1');
        } else {
            gtag('config', 'G-BVYYQS8HWY');
            gtag('config', 'G-EDHVSD1LM1');
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script defer src="js/optional_features.js?v=20241218d"></script>
    <script defer src="js/app.js?v=20241220b"></script>
</head>

<body class="dark-mode">
    <div class="gm-app-root">

        <!-- HEADER with Module Navigation -->
        <header class="gm-header">
            <div class="gm-logo-box">
                <a href="hub.html" class="gm-back-to-hub" title="Hub'a D√∂n">
                    <i class="fas fa-th-large"></i>
                </a>
                <img src="img/opradox_logo_dark.png?v=5" alt="Opradox Logo" class="gm-logo-img" id="headerLogo">
                <span class="gm-logo-subtitle" data-i18n="subtitle">Excel Studio</span>
            </div>

            <!-- Module Navigation -->
            <nav class="gm-module-nav">
                <a href="excel.html" class="gm-module-tab active" data-module="excel">
                    <i class="fas fa-file-excel"></i> <span data-i18n="module_excel">Excel</span>
                </a>
                <a href="viz.html" class="gm-module-tab" data-module="viz">
                    <i class="fas fa-chart-line"></i> <span data-i18n="module_viz">Viz</span>
                </a>
                <a href="pdf.html" class="gm-module-tab" data-module="pdf">
                    <i class="fas fa-file-pdf"></i> <span data-i18n="module_pdf">PDF</span>
                </a>
                <a href="ocr.html" class="gm-module-tab" data-module="ocr">
                    <i class="fas fa-eye"></i> <span data-i18n="module_ocr">OCR</span>
                </a>
            </nav>

            <div class="gm-header-right">
                <button id="themeToggle" class="gm-pill-btn"><i class="fas fa-moon"></i> / <i
                        class="fas fa-sun"></i></button>
                <button id="langToggle" class="gm-pill-btn"><span id="langLabel">üáπüá∑ Tr | En</span></button>
                <button id="helpToggle" class="gm-pill-btn" title="Kƒ±lavuz">
                    <i class="fas fa-question-circle"></i>
                </button>
                <button id="contactBtn" class="gm-pill-btn"><i class="fas fa-envelope"></i> <span
                        data-i18n="contact">Bize Ula≈üƒ±n</span></button>
            </div>
        </header>

        <main class="gm-main" id="mainContent">
            <!-- SOL PANEL: SADECE SENARYOLAR -->
            <section class="gm-left-pane">
                <!-- SCENARIOS SECTION -->
                <div class="gm-scenarios-section">
                    <div class="gm-card gm-scenario-list-card">
                        <h2 data-i18n="step2_title">2. Senaryonu Se√ß</h2>
                        <div class="gm-search-wrapper">
                            <i class="fas fa-search"></i>
                            <input id="scenarioSearch" class="gm-scenario-search" placeholder="..." />
                        </div>
                        <div id="scenarioListContainer" class="gm-accordion-container"></div>
                    </div>
                </div>
            </section>

            <!-- ORTA PANEL: DOSYALAR + FORM + SONU√á -->
            <section class="gm-middle-pane">
                <!-- FILES SECTION - COLLAPSIBLE -->
                <div class="gm-files-section" id="filesSection">
                    <div class="gm-card gm-upload-card">
                        <!-- Collapsible Header -->
                        <div class="gm-files-header" onclick="toggleFilesPanel()">
                            <h2 data-i18n="step1_title">1. Dosyanƒ± Y√ºkle</h2>
                            <!-- Dosya ƒ∞simleri (collapsed durumda g√∂r√ºn√ºr) -->
                            <div class="gm-file-badges" id="fileBadges">
                                <span class="gm-file-badge" id="file1Badge" style="display:none;">
                                    <i class="fas fa-file-excel"></i>
                                    <span id="file1BadgeName">-</span>
                                </span>
                                <span class="gm-file-badge gm-file-badge-secondary" id="file2Badge"
                                    style="display:none;">
                                    <i class="fas fa-copy"></i>
                                    <span id="file2BadgeName">-</span>
                                </span>
                            </div>
                            <button class="gm-files-toggle" type="button" aria-label="Toggle files panel">
                                <i class="fas fa-chevron-up"></i>
                            </button>
                        </div>

                        <!-- Collapsible Body -->
                        <div class="gm-files-body">
                            <!-- YATAY DOSYA SATIRI -->
                            <div class="gm-file-row">
                                <!-- KOLON 1: Ana Dosya Y√ºkleme -->
                                <div class="gm-file-col gm-file-upload-col">
                                    <label class="gm-file-label" id="dropZone">
                                        <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" />
                                        <i class="fas fa-file-excel" style="font-size:1.5rem; margin-bottom:4px;"></i>
                                        <span id="fileLabelText" data-i18n="file_placeholder">Ana Dosya Se√ß</span>
                                    </label>
                                    <div id="selectedFileName" class="gm-selected-file"></div>
                                </div>

                                <!-- KOLON 2: Ana Dosya Bilgi Paneli (Orijinal) -->
                                <div id="fileInfoPanel" class="gm-file-col gm-file-info" style="display:none;">
                                    <div class="gm-info-note" data-i18n="column_ref_note">
                                        üí° ƒ∞≈ülem sayfasƒ±nƒ±n ba≈üƒ±nda birle≈ütirilmi≈ü h√ºcrelerden olu≈üan ba≈ülƒ±k varsa
                                        <strong>√ñnizleme</strong> butonundan s√ºtun isimlerinin olduƒüu satƒ±rƒ± se√ßin.
                                        Buradan
                                        s√ºtun adƒ±nƒ± <strong>tƒ±klayarak kopyalayabilirsiniz</strong>. Ayrƒ±ca parametre
                                        alanƒ±na
                                        <strong>s√ºtun adƒ±</strong>, <strong>harf kodu (A, B...)</strong> da yazabilir ya
                                        da
                                        <strong>listeden se√ßebilirsiniz</strong>. Aynƒ± parametrede birden fazla s√ºtun
                                        i√ßin
                                        i≈ülem
                                        yapƒ±lacaksa s√ºtun isimlerini virg√ºl ve bo≈üluk bƒ±rakarak yazƒ±n.
                                    </div>
                                    <div class="gm-info-stats">
                                        <span><i class="fas fa-table"></i> <strong id="fileRowCount">0</strong> <span
                                                data-i18n="info_rows">satƒ±r</span></span>
                                        <span><i class="fas fa-columns"></i> <strong id="fileColCount">0</strong> <span
                                                data-i18n="info_cols">s√ºtun</span></span>
                                    </div>
                                    <div id="fileColumnList" class="gm-column-chips"></div>
                                </div>

                                <!-- KOLON 3: ƒ∞kinci Dosya (Toggle + Crosssheet + Upload) -->
                                <div class="gm-file-col gm-file-col-secondary" id="secondFileCol">
                                    <!-- ƒ∞kinci Dosya Ekle Butonu -->
                                    <div class="gm-second-file-toggle" id="secondFileToggle"
                                        onclick="toggleSecondFile()">
                                        <i class="fas fa-plus-circle"></i> <span data-i18n="add_second_file">ƒ∞kinci
                                            Dosya
                                            Ekle</span>
                                    </div>

                                    <div id="secondFileWrapper" class="gm-second-file-wrapper" style="display:none;">
                                        <!-- Crosssheet se√ßeneƒüi (Orijinal) -->
                                        <div class="gm-crosssheet-option" id="crossSheetOption" style="display:none;">
                                            <label class="gm-crosssheet-checkbox">
                                                <input type="checkbox" id="useSameFileDifferentSheet"
                                                    onchange="toggleCrossSheetMode()">
                                                <span data-i18n="use_same_file_sheet">Ana dosyadan farklƒ± sayfa
                                                    kullan</span>
                                            </label>
                                            <div id="crossSheetSelector"
                                                class="gm-crosssheet-selector pro-crosssheet-selector"
                                                style="display:none; align-items:center; gap:8px; margin-top:5px;">
                                                <div style="flex:0 0 auto; display:flex; align-items:center; gap:6px;">
                                                    <label class="gm-sheet-label" style="font-size:0.8rem;">
                                                        <i class="fas fa-layer-group"></i> <span
                                                            data-i18n="select_sheet">Sayfa:</span>
                                                    </label>
                                                    <select id="crossSheetSelect" class="gm-sheet-select"
                                                        onchange="fetchCrossSheetColumns(this)"></select>
                                                </div>
                                                <div class="pro-crosssheet-columns"
                                                    style="flex:1; min-width:0; padding:2px 8px; background:var(--gm-bg); border-radius:4px; font-size:0.7rem; overflow:hidden; border:1px solid var(--gm-card-border); display:flex; align-items:center;">
                                                    <div class="pro-crosssheet-column-list gm-column-chips"
                                                        style="display:flex; flex-wrap:nowrap; overflow-x:auto; gap:4px; align-items:center; white-space:nowrap; padding-bottom:2px; height:24px; scrollbar-width:thin;">
                                                        <span
                                                            style="color:var(--gm-text-muted); font-size:0.7rem; font-style:italic;">Sayfa
                                                            se√ßin...</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ƒ∞kinci dosya y√ºkleme alanƒ± -->
                                        <div id="file2UploadArea">
                                            <label class="gm-file-label" id="dropZone2" style="border-style:dotted;">
                                                <input type="file" id="fileInput2" accept=".xlsx,.xls,.csv" />
                                                <i class="fas fa-copy" style="font-size:1.2rem; margin-bottom:5px;"></i>
                                                <span id="fileLabelText2" style="font-size:0.8rem;"
                                                    data-i18n="file_placeholder_2">ƒ∞kinci Dosya (Opsiyonel)</span>
                                            </label>
                                            <div id="selectedFileName2" class="gm-selected-file"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- KOLON 4: ƒ∞kinci Dosya Bilgi Paneli (Orijinal) -->
                                <div id="fileInfoPanel2" class="gm-file-col gm-file-info" style="display:none;">
                                    <div class="gm-info-note" data-i18n="column_ref_note_2">
                                        üí° <strong>ƒ∞kinci dosya</strong> s√ºtun adlarƒ±nƒ± tƒ±klayarak kopyalayabilirsiniz.
                                    </div>
                                    <div id="fileSheetSelect2Container" style="display:none; margin-bottom:8px;"></div>
                                    <div class="gm-info-stats">
                                        <span><i class="fas fa-table"></i> <strong id="fileRowCount2">0</strong> <span
                                                data-i18n="info_rows">satƒ±r</span></span>
                                        <span><i class="fas fa-columns"></i> <strong id="fileColCount2">0</strong> <span
                                                data-i18n="info_cols">s√ºtun</span></span>
                                    </div>
                                    <div id="fileColumnList2" class="gm-column-chips"></div>
                                </div>
                            </div>
                        </div>
                        <!-- /gm-files-body -->
                    </div>
                </div>
                <datalist id="file2-columns"></datalist>

                <!-- SENARYO FORMU -->
                <div class="gm-card gm-scenario-card">
                    <div class="gm-card-header">
                        <h2 id="scenarioTitle" data-i18n="step3_title">3. Senaryo Ayarlarƒ±</h2>
                    </div>
                    <p id="scenarioSubtitle" class="gm-muted" data-i18n="no_selection">L√ºtfen soldan bir senaryo se√ßin.
                    </p>
                    <div id="dynamicFormContainer">
                        <div class="gm-info-box" style="text-align:center; padding:30px; opacity:0.6;">
                            <i class="fas fa-arrow-left fa-2x"></i><br>Se√ßim Bekleniyor...
                        </div>
                    </div>
                </div>

                <div class="gm-card gm-result-card">
                    <div class="gm-result-header">
                        <h2 data-i18n="results_title">Sonu√ß</h2>
                        <div class="gm-result-share" id="resultShareContainer" style="position:relative;">
                            <button class="gm-pill-btn" id="resultShareBtn">
                                <i class="fas fa-share-alt"></i> <span data-i18n="share_result">Sonu√ß Payla≈ü</span>
                            </button>
                            <div id="resultShareDropdown" style="display:none;"></div>
                        </div>
                    </div>
                    <div id="statusMessage" class="gm-status"></div>
                    <div id="markdownResult" class="gm-markdown-result"
                        style="display:none; padding:10px; border:1px solid var(--gm-card-border); border-radius:6px; margin-bottom:10px;">
                    </div>
                    <pre id="resultJson" class="gm-result-json">// Sonu√ßlar burada g√∂r√ºnecek.</pre>
                    <div id="downloadExcelPlaceholder"></div>

                    <!-- Inline Feedback Widget -->
                    <div id="inlineFeedbackWidget" class="gm-inline-feedback" style="display:none;">
                        <div class="gm-feedback-header">
                            <span data-i18n="feedback_question">Bu sonu√ß i≈üinize yaradƒ± mƒ±?</span>
                        </div>
                        <div class="gm-star-rating" id="starRating">
                            <span class="gm-star" data-value="1">‚òÖ</span>
                            <span class="gm-star" data-value="2">‚òÖ</span>
                            <span class="gm-star" data-value="3">‚òÖ</span>
                            <span class="gm-star" data-value="4">‚òÖ</span>
                            <span class="gm-star" data-value="5">‚òÖ</span>
                        </div>
                        <div class="gm-feedback-form" id="feedbackForm" style="display:none;">
                            <input type="text" id="feedbackName" data-i18n-placeholder="feedback_name_placeholder"
                                placeholder="ƒ∞sminiz (opsiyonel)" maxlength="100">
                            <textarea id="feedbackMessage" data-i18n-placeholder="feedback_message_placeholder"
                                placeholder="G√∂r√º≈ü√ºn√ºz..." rows="2" maxlength="1000"></textarea>
                            <div class="gm-feedback-type-btns">
                                <button type="button" class="gm-type-btn" data-type="thanks"
                                    title="Te≈üekk√ºr">üíö</button>
                                <button type="button" class="gm-type-btn" data-type="suggestion"
                                    title="√ñneri">üí°</button>
                                <button type="button" class="gm-type-btn active" data-type="comment"
                                    title="Yorum">üí¨</button>
                                <button type="button" class="gm-type-btn" data-type="bug" title="Hata">üêõ</button>
                            </div>
                            <button id="submitFeedbackBtn" class="gm-gradient-btn">
                                <i class="fas fa-paper-plane"></i> <span data-i18n="feedback_submit_btn">G√∂nder</span>
                            </button>
                        </div>
                        <div id="feedbackSuccess" class="gm-feedback-success" style="display:none;">
                            <span data-i18n="feedback_success_message">‚ú® Te≈üekk√ºrler!</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SAƒû PANEL: KILAVUZ (Collapse Edilebilir) -->
            <section class="gm-right-pane" id="helpPane">
                <div class="gm-card gm-help-card">
                    <div class="gm-help-header">
                        <h2 data-i18n="help_title">Kullanƒ±m Kƒ±lavuzu</h2>
                        <button class="gm-pill-btn help-close-btn" id="helpCloseBtn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="helpContentArea">
                        <div class="gm-help-placeholder">
                            <i class="fas fa-book-open"></i>
                            <p>Detaylar i√ßin senaryo se√ßin.</p>
                        </div>
                    </div>

                    <div id="helpTemplate" style="display:none;">
                        <div class="gm-help-section">
                            <h4 class="gm-help-subtitle" data-i18n="help_subtitle_what">Nedir?</h4>
                            <p id="scenarioWhatIs" class="gm-help-text"></p>
                        </div>
                        <div class="gm-help-section">
                            <h4 class="gm-help-subtitle" data-i18n="help_subtitle_how">Nasƒ±l Kullanƒ±lƒ±r?</h4>
                            <ol id="scenarioHowTo" class="gm-help-list"></ol>
                        </div>
                        <div class="gm-help-section">
                            <h4 class="gm-help-subtitle" data-i18n="help_subtitle_example">√ñrnek</h4>
                            <ul id="scenarioExamples" class="gm-help-list"></ul>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- TOPLULUK PANOSU -->
        <div class="gm-comments-wrapper collapsed" id="commentsWrapper">
            <div class="gm-comments-header">
                <span data-i18n="community_title">üí¨ Topluluk Panosu</span>
                <i class="fas fa-chevron-up"></i>
            </div>
            <div class="gm-comments-body">
                <div class="gm-comments-container">
                    <div id="commentsList" class="gm-comments-list"></div>
                    <div class="gm-comment-input-box">
                        <textarea id="publicComment" placeholder="..."></textarea>
                        <button id="sendCommentBtn" class="gm-gradient-btn" style="height:fit-content;"
                            data-i18n="send_btn">G√∂nder</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTACT MODAL -->
    <div id="contactModal" class="gm-modal">
        <div class="gm-modal-content">
            <span class="gm-close-modal">&times;</span>
            <div class="gm-modal-left">
                <h2 data-i18n="modal_about_title">Hakkƒ±mƒ±zda</h2>
                <p data-i18n="modal_about_desc">Opradox, veri i≈üleme s√ºre√ßlerinizi hƒ±zlandƒ±ran g√º√ßl√º bir ara√ß setidir.
                </p>
            </div>
            <div class="gm-modal-right">
                <h2 data-i18n="contact_modal_title" style="color:var(--gm-text); margin-bottom:15px; border:none;">Bize
                    Ula≈üƒ±n</h2>
                <form id="contactForm">
                    <div class="gm-form-row">
                        <label data-i18n="lbl_name">Ad Soyad</label>
                        <input type="text" id="contactName" required>
                    </div>
                    <div class="gm-form-row">
                        <label data-i18n="lbl_email">E-posta</label>
                        <input type="email" id="contactEmail" required>
                    </div>
                    <div class="gm-form-row">
                        <label data-i18n="lbl_msg">Mesajƒ±nƒ±z</label>
                        <textarea id="contactMessage" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="gm-gradient-btn" style="width:100%"
                        data-i18n="send_btn">G√∂nder</button>
                </form>
            </div>
        </div>
    </div>

    <!-- QUEUE MODAL -->
    <div id="queueModal" class="gm-queue-modal">
        <div class="gm-queue-card">
            <div class="gm-queue-icon">
                <i class="fas fa-hourglass-half"></i>
            </div>
            <div id="qm_status" class="gm-queue-status">
                Sƒ±ra Bekleniyor...
            </div>
            <div class="gm-queue-details">
                <div class="gm-queue-detail-item">
                    <span data-i18n="queue_pos">Sƒ±ra</span>
                    <span id="qm_position" class="gm-queue-detail-value">-</span>
                </div>
                <div class="gm-queue-detail-item">
                    <span data-i18n="elapsed_time">S√ºre</span>
                    <span id="qm_time" class="gm-queue-detail-value">0s</span>
                </div>
            </div>
            <div class="gm-queue-load">
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:5px;">
                    <span data-i18n="server_load">Sunucu Y√ºk√º</span>
                    <span id="qm_load_text" style="font-weight:600;">%0</span>
                </div>
                <div class="gm-load-bar-bg">
                    <div id="qm_load_bar" class="gm-load-bar"></div>
                </div>
            </div>
            <div style="margin-top:20px;">
                <button onclick="closeQueueModal()" class="gm-pill-btn" style="font-size:0.75rem; opacity:0.7;">
                    <i class="fas fa-times"></i> <span data-i18n="cancel_job">ƒ∞ptal Et</span>
                </button>
            </div>
        </div>
    </div>

    <!-- FILE PREVIEW MODAL -->
    <div id="filePreviewModal" class="gm-modal">
        <div class="gm-modal-content" style="max-width:90%; max-height:80vh;">
            <div class="gm-modal-header">
                <h3><i class="fas fa-table"></i> <span data-i18n="preview_title">Dosya √ñnizleme</span></h3>
                <button class="gm-modal-close" onclick="closePreviewModal()">&times;</button>
            </div>
            <div class="gm-modal-body" id="previewModalBody">
                <!-- √ñnizleme i√ßeriƒüi JS ile doldurulacak -->
            </div>
        </div>
    </div>

    <!-- Datalists for autocomplete -->
    <datalist id="file1-columns"></datalist>

    <!-- Help Toggle Script - app.js'den sonra √ßalƒ±≈ümasƒ± i√ßin setTimeout -->
    <script>
        // app.js defer ile y√ºklendikten sonra √ßalƒ±≈üsƒ±n
        window.addEventListener('load', () => {
            console.log('[Excel] Help toggle script ba≈ülatƒ±lƒ±yor...');

            const helpToggle = document.getElementById('helpToggle');
            const helpCloseBtn = document.getElementById('helpCloseBtn');
            const mainContent = document.getElementById('mainContent');

            console.log('[Excel] Elementler:', {
                helpToggle: !!helpToggle,
                helpCloseBtn: !!helpCloseBtn,
                mainContent: !!mainContent
            });

            function toggleHelpPane() {
                console.log('[Excel] toggleHelpPane √ßaƒürƒ±ldƒ±');
                if (mainContent) {
                    mainContent.classList.toggle('help-collapsed');
                    console.log('[Excel] help-collapsed:', mainContent.classList.contains('help-collapsed'));
                }
            }

            if (helpToggle) {
                helpToggle.addEventListener('click', toggleHelpPane);
                console.log('[Excel] helpToggle listener eklendi');
            }

            if (helpCloseBtn) {
                helpCloseBtn.addEventListener('click', toggleHelpPane);
                console.log('[Excel] helpCloseBtn listener eklendi');
            }

            // Kƒ±lavuz varsayƒ±lan kapalƒ±
            if (mainContent && !mainContent.classList.contains('help-collapsed')) {
                mainContent.classList.add('help-collapsed');
                console.log('[Excel] Varsayƒ±lan help-collapsed eklendi');
            }
        });

        // Dosya paneli toggle fonksiyonu
        function toggleFilesPanel() {
            const filesSection = document.getElementById('filesSection');
            if (filesSection) {
                filesSection.classList.toggle('collapsed');
            }
        }

        // Dosya badge'lerini g√ºncelle
        function updateFileBadges() {
            const file1Name = document.getElementById('selectedFileName');
            const file2Name = document.getElementById('selectedFileName2');
            const badge1 = document.getElementById('file1Badge');
            const badge1Name = document.getElementById('file1BadgeName');
            const badge2 = document.getElementById('file2Badge');
            const badge2Name = document.getElementById('file2BadgeName');

            // Dosya 1
            if (file1Name && file1Name.textContent.trim()) {
                badge1.style.display = 'inline-flex';
                badge1Name.textContent = file1Name.textContent.trim();
            } else {
                badge1.style.display = 'none';
            }

            // Dosya 2
            if (file2Name && file2Name.textContent.trim()) {
                badge2.style.display = 'inline-flex';
                badge2Name.textContent = file2Name.textContent.trim();
            } else {
                badge2.style.display = 'none';
            }
        }

        // Dosya isim deƒüi≈üikliklerini izle
        window.addEventListener('load', () => {
            const observer = new MutationObserver(updateFileBadges);
            const file1El = document.getElementById('selectedFileName');
            const file2El = document.getElementById('selectedFileName2');

            if (file1El) observer.observe(file1El, { childList: true, characterData: true, subtree: true });
            if (file2El) observer.observe(file2El, { childList: true, characterData: true, subtree: true });
        });

        // Toast bildirim fonksiyonu
        function showToast(message, type = 'info', duration = 4000) {
            // Mevcut toast varsa kaldƒ±r
            const existing = document.querySelector('.gm-excel-toast');
            if (existing) existing.remove();

            const toast = document.createElement('div');
            toast.className = `gm-excel-toast gm-excel-toast-${type}`;
            toast.innerHTML = `<span>${message}</span>`;
            document.body.appendChild(toast);

            // Animasyonla g√∂ster
            setTimeout(() => toast.classList.add('show'), 10);

            // Otomatik kapat
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // Global eri≈üim i√ßin
        window.showToast = showToast;
    </script>

</body>

</html>